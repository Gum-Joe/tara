{
  "version": 3,
  "file": "menu.js",
  "sourceRoot": "..",
  "sources": [
    "src\\menu.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "# out: ../lib/menu.js, sourcemap: true\r\n###\r\n# @overview Menu Class\r\n# @module tara-right-click-menu\r\n###\r\n{ Menu, MenuItem, remote } = require \"electron\" if typeof window == \"undefined\"\r\n{ join } = require \"path\"\r\n{ eachSeries } = require \"async\"\r\n{ TARA_CONFIG_DBS } = require \"tara-core/lib/constants.js\"\r\nDB = require \"nedb\"\r\nif typeof window != \"undefined\"\r\n  { remote } = require \"electron\"\r\n  { Menu, MenuItem } = remote\r\n\r\n# TMP store db\r\ntmp = new DB({ filename: join(TARA_CONFIG_DBS, \"right-click-context-menu\", \"tmp.db\"), autoload: true })\r\ntmp.insert({ idCount: 0 })\r\n\r\n###\r\n# Menu class\r\n# @param {String} name Name of db\r\n# @class\r\n###\r\nclass TaraMenu\r\n\r\n  constructor: (name) ->\r\n    # Menu items\r\n    @Item = MenuItem\r\n    @menu = new Menu()\r\n    # Create db for menus\r\n    @name = name\r\n    @db = new DB({ filename: join(TARA_CONFIG_DBS, \"right-click-context-menu\", \"#{@name}.db\"), autoload: true })\r\n\r\n  ###\r\n  # Run the menu if a certain statement is met\r\n  # @param {Function} test Function to return either true or false for whether or not to pop up\r\n  # @returns {void} Nothing\r\n  ###\r\n  applyIf: (test) ->\r\n    @checkApply = test\r\n\r\n  ###\r\n  # Appends item to menu db\r\n  # @param {object} item Menu item\r\n  ###\r\n  append: (item) ->\r\n    db = @db\r\n    # Check if item is already there\r\n    db.find({ item }, (err, docs) ->\r\n      throw err if err\r\n      # Look for next id\r\n      tmp.find({ idCount: { $exists: true }}, (err, count) ->\r\n        throw err if err\r\n        # Insert\r\n        if docs.length == 0\r\n          db.insert({ item, id: count[0].idCount || item.id })\r\n          # Update ID count\r\n          tmp.update({ idCount: /.*/ }, { $set: { idCount: count[0].idCount++ || item.id++  } }, {}, (err) -> throw err if err)\r\n      )\r\n    )\r\n\r\n  ###\r\n  # Start listenning for the event\r\n  # @returns {void} Nothing\r\n  ###\r\n  listen: () ->\r\n    console.log \"Now listenning (menu)\"\r\n    that = @\r\n    window.addEventListener(\"contextmenu\", (event) ->\r\n      event.preventDefault()\r\n      # Remake menu from db\r\n      db = new DB({ filename: join(TARA_CONFIG_DBS, \"right-click-context-menu\", \"#{that.name}.db\"), autoload: true })\r\n      db.find({}, (err, docs) ->\r\n        throw err if err\r\n        template = []\r\n        for item in docs\r\n          # Resolve click & append to to append array (in order)\r\n          item.item.click = require item.item.click if item.item.hasOwnProperty \"click\"\r\n          item.item.id = item.item.id\r\n          item.item = new MenuItem item.item\r\n          template[item.item.id] = item.item\r\n        menu = Menu.buildFromTemplate(template)\r\n        menu.popup(remote.getCurrentWindow())\r\n        # Add to menu add popup when done\r\n        ###\r\n        eachSeries(docs, (item, callback) ->\r\n          console.log item\r\n          menu.append(item.item)\r\n          callback()\r\n        , () ->\r\n          menu.popup(remote.getCurrentWindow())\r\n        )\r\n        ###\r\n      )\r\n    , false)\r\n\r\nmodule.exports = TaraMenu\r\n"
  ]
}